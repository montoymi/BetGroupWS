<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="PollaHeaders">

    <resultMap id="selectResult" type="PollaHeader">
        <result property="pollaId" column="id"/>
        <result property="pollaName" column="polla_name"/>
        <result property="templateHeaderId" column="template_header_id"/>
        <result property="adminId" column="admin_user_id"/>
        <result property="pollaCost" column="credit_amount"/>
        <result property="accessFlag" column="access_flag"/>
        <result property="enabled_flag" column="status"/>
        <result property="password" column="password"/>
        <result property="costFlag" column="cost_flag"/>
    </resultMap>


    <select id="getMisPollasByUserId" parameterType="int" resultMap="selectResult">
        SELECT ph.* FROM polla_headers AS ph, polla_participants AS pp
        WHERE ph.id = pp.polla_header_id AND pp.user_id = #{userId}
    </select>

    <select id="getPollasDisponiblesByUserId" parameterType="int" resultMap="selectResult">
        select *
        from polla_headers as ph
        where not exists (select 1
        from polla_participants pp
        where pp.polla_header_id = ph.id
        and pp.user_id = #{userId})
    </select>



</mapper>